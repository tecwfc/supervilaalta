<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no"
    />
    <title>Supervila ‚Äì Caixa</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
       <link rel="stylesheet" href="style.css">
   
  </head>
  <body>
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     LOGIN SCREEN
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="telaLogin">
      <div class="login-card">
        <div class="login-logo">
          <div class="badge"><span>SUPERVILA</span></div>
          <h2>Controle de Caixa</h2>
          <p>Entre com suas credenciais</p>
        </div>
        <div id="loginForm">
          <div class="field">
            <label>Usu√°rio</label>
            <input
              type="text"
              id="inputUsuario"
              placeholder="Digite seu usu√°rio"
              autocomplete="off"
              onkeypress="
                if (event.key === 'Enter')
                  document.getElementById('inputSenha').focus();
              "
            />
          </div>
          <div class="field">
            <label>Senha</label>
            <div class="pwd-wrap">
              <input
                type="password"
                id="inputSenha"
                placeholder="Digite sua senha"
                autocomplete="off"
                onkeypress="if (event.key === 'Enter') verificarLogin();"
              />
              <button
                type="button"
                class="pwd-toggle"
                onclick="toggleSenha('inputSenha', this)"
              >
                üëÅÔ∏è
              </button>
            </div>
          </div>
          <div class="msg-erro" id="msgErro">
            ‚ùå Usu√°rio ou senha inv√°lidos!
          </div>
          <button class="btn-login" onclick="verificarLogin()">
            Entrar no Sistema
          </button>
        </div>
        <div class="spinner-wrap" id="carregando">
          <div class="spinner"></div>
          <p>Verificando credenciais‚Ä¶</p>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     APP
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="app">
      <!-- Top bar (mobile only) -->
      <div class="topbar">
        <div class="logo-sm">
          <div class="badge-sm"><span>SUPERVILA</span></div>
          <div class="unidade-sm" id="topUnidade">‚Äî</div>
        </div>
        <button class="btn-logout" onclick="fazerLogout()">üö™</button>
      </div>

      <!-- Sidebar (desktop only) -->
      <aside class="sidebar" style="display: none">
        <div class="logo-area">
          <div class="badge"><span>SUPERVILA</span></div>
          <div class="unit-badge">
            <div class="lbl2">Unidade</div>
            <div class="val2" id="sideUnidade">‚Äî</div>
          </div>
        </div>
        <nav>
          <button class="nav-item active" onclick="mudarTab('dash', this)">
            <span class="nav-icon">üìä</span> Dashboard
          </button>
          <button class="nav-item" onclick="mudarTab('lancar', this)">
            <span class="nav-icon">‚ûï</span> Novo Lan√ßamento
          </button>
          <button class="nav-item" onclick="mudarTab('historico', this)">
            <span class="nav-icon">üìñ</span> Livro de Caixa
          </button>
          <button class="nav-item" onclick="mudarTab('config', this)">
            <span class="nav-icon">‚öôÔ∏è</span> Configura√ß√µes
          </button>
        </nav>
        <div class="user-box">
          <div class="lbl">Logado como</div>
          <div class="name" id="sideUsuario">‚Äî</div>
          <button class="btn-logout-desk" onclick="fazerLogout()">
            Sair do Sistema
          </button>
        </div>
      </aside>

      <!-- Scrollable content -->
      <div class="content-scroll">
        <!-- ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ -->
        <div class="page active" id="tab-dash">
          <div class="greeting">
            <h1>Ol√°, <span id="nomeOperador">Operador</span> üëã</h1>
            <p>Unidade: <span class="unit" id="txtUnidade">‚Äî</span></p>
          </div>
          <div class="cards-grid">
            <div class="card-stat green">
              <div class="lbl">Recebido</div>
              <div class="val" id="cardReceitas">R$ 0,00</div>
            </div>
            <div class="card-stat rose">
              <div class="lbl">Pago</div>
              <div class="val" id="cardPago">R$ 0,00</div>
            </div>
            <div class="card-stat orange">
              <div class="lbl">Fluxo</div>
              <div class="val" id="cardFluxo">R$ 0,00</div>
            </div>
            <div class="card-stat slate">
              <div class="lbl">Saldo Pr√©vio</div>
              <div class="val" id="cardPrevio">R$ 0,00</div>
            </div>
            <div class="card-stat highlight">
              <div class="lbl">Saldo em Caixa</div>
              <div class="val" id="cardSaldo">R$ 0,00</div>
            </div>
          </div>
          <div class="chart-row">
            <div class="chart-box">
              <h4>Propor√ß√£o</h4>
              <canvas id="graficoPizza"></canvas>
            </div>
            <div class="chart-box">
              <h4>Comparativo</h4>
              <canvas id="graficoBarras"></canvas>
            </div>
          </div>
        </div>

        <!-- ‚îÄ‚îÄ NOVO LAN√áAMENTO ‚îÄ‚îÄ -->
        <!-- ‚îÄ‚îÄ NOVO LAN√áAMENTO ‚îÄ‚îÄ -->
<div class="page" id="tab-lancar">
  <div class="page-header"><span class="bar"></span> Novo Registro</div>
  <div class="form-card">
    <div class="field">
      <label>Data</label><input type="date" id="data" />
    </div>
    <div class="field">
      <label>Descri√ß√£o</label>
      <select id="desc" onchange="preencherDescricao(this.value)">
        <option value="">Selecione uma descri√ß√£o...</option>
        <!-- As descri√ß√µes ser√£o carregadas aqui via JavaScript -->
      </select>
      <input
        type="text"
        id="descManual"
        placeholder="Ou digite manualmente"
        style="margin-top: 8px; display: none;"
      />
    </div>
    <div class="row2">
      <div class="field">
        <label>Tipo</label>
        <select id="tipoOperacao">
          <option value="recebido">Entrada (Recebido)</option>
          <option value="pago">Sa√≠da (Pagamento)</option>
        </select>
      </div>
      <div class="field">
        <label>Valor (R$)</label>
        <input
          type="number"
          step="0.01"
          id="valor"
          placeholder="0,00"
          inputmode="decimal"
        />
      </div>
    </div>

    <div class="form-actions">
      <button class="btn-primary" id="btnLancar" onclick="lancar()">
        <span class="btn-icon">üíæ</span>
        <span class="btn-text">Salvar no Livro</span>
      </button>
      <button class="btn-clean" onclick="limparCamposLancamento()">
        <span class="btn-icon">üßπ</span>
        <span class="btn-text">Limpar Campos</span>
      </button>
    </div>
  </div>
</div>
        <!-- ‚îÄ‚îÄ LIVRO DE CAIXA ‚îÄ‚îÄ -->
        <div class="page" id="tab-historico">
          <div class="livro-header">
            <div class="page-header">
              <span class="bar"></span> Livro de Caixa
            </div>
          </div>
          <div class="saldo-previo-banner">
            <div><div class="lbl">Saldo Pr√©vio</div></div>
            <div class="val" id="bannerPrevio">R$ 0,00</div>
          </div>

          <div class="filter-strip">
            <div class="filter-label">üìÑ Gerar PDF por per√≠odo</div>
            <div class="filter-row">
              <select id="filtroTipo" onchange="atualizarFiltroPeriodo()">
                <option value="mes">Por M√™s</option>
                <option value="periodo">Por Per√≠odo</option>
              </select>
              <div id="wrapMes" style="display: contents">
                <select id="filtroMes"></select>
                <select id="filtroMesAno"></select>
              </div>
              <div
                id="wrapPeriodo"
                style="display: none; display: none; contents: none"
              >
                <input type="date" id="filtroPeriodoInicio" />
                <input type="date" id="filtroPeriodoFim" />
              </div>
              <button class="btn-pdf" onclick="gerarPDFLivroCaixa()">
                üìÑ PDF
              </button>
            </div>
          </div>

          <div id="libroCards"></div>
        </div>

        <!-- ‚îÄ‚îÄ CONFIGURA√á√ïES ‚îÄ‚îÄ -->
        <div class="page" id="tab-config">
          <div class="config-card">
            <div class="icon-wrap">‚öôÔ∏è</div>
            <h3>Saldo Inicial</h3>
            <p class="sub">‚ö†Ô∏è Requer senha de autoriza√ß√£o</p>
            <div class="field">
              <label>Novo Saldo Inicial</label>
              <input
                type="number"
                step="0.01"
                id="inputSaldoPrevio"
                placeholder="0,00"
              />
            </div>
            <div class="field">
              <label>üîê Senha de Confirma√ß√£o</label>
              <div class="pwd-wrap">
                <input
                  type="password"
                  id="senhaConfirmacao"
                  placeholder="Senha de autoriza√ß√£o"
                  onkeypress="if (event.key === 'Enter') salvarConfiguracoes();"
                />
                <button
                  type="button"
                  class="pwd-toggle"
                  onclick="toggleSenha('senhaConfirmacao', this)"
                >
                  üëÅÔ∏è
                </button>
              </div>
            </div>
            <div class="msg-erro" id="msgErroConfig"></div>
            <div class="msg-sucesso" id="msgSucessoConfig">
              ‚úÖ Saldo atualizado com sucesso!
            </div>
            <button
              class="btn-dark"
              id="btnSalvarConfig"
              onclick="salvarConfiguracoes()"
            >
              Atualizar Saldo
            </button>

            <!-- NOVA SE√á√ÉO: CADASTRO DE DESCRI√á√ïES -->
            <div style="margin-top: 40px; border-top: 1px solid var(--slate-200); padding-top: 24px;">
              <h3 style="font-size: 17px; font-weight: 800; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                <span style="width: 4px; height: 22px; background: var(--red); border-radius: 2px;"></span>
                Cadastro de Descri√ß√µes
              </h3>
              
              <div class="field">
                <label>Nova Descri√ß√£o</label>
                <input type="text" id="novaDescricao" placeholder="Ex: Pagamento de fornecedor" />
              </div>
              
              <div class="msg-erro" id="msgErroDescricao" style="display: none;"></div>
              <div class="msg-sucesso" id="msgSucessoDescricao" style="display: none;"></div>
              
              <button class="btn-primary" onclick="cadastrarDescricao()" style="margin-top: 12px;">
                <span class="btn-icon">üíæ</span>
                <span class="btn-text">Salvar Descri√ß√£o</span>
              </button>
              
              <!-- LISTA DE DESCRI√á√ïES CADASTRADAS -->
              <div style="margin-top: 24px;">
                <h4 style="font-size: 13px; font-weight: 700; color: var(--slate-500); margin-bottom: 12px;">
                  Descri√ß√µes Cadastradas
                </h4>
                <div id="listaDescricoes" style="max-height: 200px; overflow-y: auto; background: var(--slate-50); border-radius: 12px; padding: 12px;">
                  <!-- As descri√ß√µes ser√£o carregadas aqui -->
                </div>
              </div>
            </div>

            <div class="info-box">
              <div class="info-title">‚ÑπÔ∏è Informa√ß√£o</div>
              <p>
                O saldo inicial representa o valor em caixa antes dos lan√ßamentos. Requer senha para seguran√ßa.
                <br><br>
                <strong>Descri√ß√µes:</strong> Cadastre aqui as descri√ß√µes que aparecer√£o como sugest√£o ao fazer lan√ßamentos.
              </p>
            </div>
          </div>
        </div>
      </div>

      <!-- Bottom nav (mobile only) -->
      <nav class="bottom-nav">
        <button class="nav-btn active" onclick="mudarTab('dash', this)">
          <span class="nav-icon">üìä</span> Dashboard
        </button>
        <button class="nav-btn" onclick="mudarTab('lancar', this)">
          <span class="nav-icon">‚ûï</span> Novo
        </button>
        <button class="nav-btn" onclick="mudarTab('historico', this)">
          <span class="nav-icon">üìñ</span> Livro
        </button>
        <button class="nav-btn" onclick="mudarTab('config', this)">
          <span class="nav-icon">‚öôÔ∏è</span> Config
        </button>
      </nav>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MODAL EDITAR
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div
      class="modal-overlay"
      id="modalEditar"
      onclick="if (event.target === this) fecharModal();"
    >
      <div class="modal-box">
        <div class="modal-top">
          <h3>‚úèÔ∏è Editar Registro</h3>
          <button class="modal-close" onclick="fecharModal()">√ó</button>
        </div>
        <input type="hidden" id="editId" />
        <div class="field">
          <label>Data</label><input type="date" id="editData" />
        </div>
        <div class="field">
          <label>Descri√ß√£o</label><input type="text" id="editDesc" />
        </div>
        <div
          class="row2"
          style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px"
        >
          <div class="field">
            <label>Tipo</label>
            <select id="editTipo">
              <option value="recebido">Entrada (Recebido)</option>
              <option value="pago">Sa√≠da (Pagamento)</option>
            </select>
          </div>
          <div class="field">
            <label>Valor (R$)</label>
            <input
              type="number"
              step="0.01"
              id="editValor"
              inputmode="decimal"
            />
          </div>
        </div>
        <div class="modal-actions">
          <button
            class="btn-primary"
            id="btnSalvarEditar"
            onclick="salvarEditar()"
          >
            Salvar
          </button>
          <button class="btn-cancel" onclick="fecharModal()">Cancelar</button>
        </div>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
