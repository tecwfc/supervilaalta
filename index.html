<!doctype html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Supervila ‚Äì Caixa</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800;900&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="style.css">


  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#e31d1a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body>
  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     LOGIN SCREEN
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="telaLogin">
      <div class="login-card">
        <!-- <div class="login-logo">
          <div class="badge"><span>SUPERVILA</span></div> -->


          <div class="login-logo">
  <img src="assets/logo_supervila.png" alt="Logo Supervila" style="width: 120px; height: auto; margin-bottom: 10px;">
</div>
   
          <h2>Controle de Caixa</h2>
          <p>Entre com suas credenciais</p>
        </div>
        <div id="loginForm">
          <div class="field">
            <label>Usu√°rio</label>
            <input
              type="text"
              id="inputUsuario"
              placeholder="Digite seu usu√°rio"
              autocomplete="off"
              onkeypress="
                if (event.key === 'Enter')
                  document.getElementById('inputSenha').focus();
              "
            />
          </div>
          <div class="field">
            <label>Senha</label>
            <div class="pwd-wrap">
              <input
                type="password"
                id="inputSenha"
                placeholder="Digite sua senha"
                autocomplete="off"
                onkeypress="if (event.key === 'Enter') verificarLogin();"
              />
              <button
                type="button"
                class="pwd-toggle"
                onclick="toggleSenha('inputSenha', this)"
              >
                üëÅÔ∏è
              </button>
            </div>
          </div>
          <div class="msg-erro" id="msgErro">
            ‚ùå Usu√°rio ou senha inv√°lidos!
          </div>
          <button class="btn-login" onclick="verificarLogin()">
            Entrar no Sistema
          </button>
        </div>
        <div class="spinner-wrap" id="carregando">
          <div class="spinner"></div>
          <p>Verificando credenciais‚Ä¶</p>
        </div>
      </div>
    </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     APP
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div id="app">
    <!-- Top bar (mobile only) -->
    <div class="topbar">
      <div class="logo-sm">
   <img src="assets/logo_supervila.png" alt="Supervila" class="logo-top">
  <div class="unidade-sm" id="topUnidade">‚Äî</div>
</div>

      <button class="btn-logout" onclick="fazerLogout()">üö™</button>
    </div>

    <!-- Sidebar (desktop only) -->
    <aside class="sidebar" style="display: none">
      <div class="logo-area">
  <img src="assets/logo_supervila.png" alt="Supervila" class="logo-sidebar">
  <div class="unit-badge">

          <div class="lbl2">Unidade</div>
          <div class="val2" id="sideUnidade">‚Äî</div>
        </div>
      </div>
      <nav>
        <button class="nav-item active" onclick="mudarTab('dash', this)">
          <span class="nav-icon">üìä</span> Dashboard
        </button>
        <button class="nav-item" onclick="mudarTab('lancar', this)">
          <span class="nav-icon">‚ûï</span> Novo Lan√ßamento
        </button>
        <button class="nav-item" onclick="mudarTab('historico', this)">
          <span class="nav-icon">üìñ</span> Livro de Caixa
        </button>
        <button class="nav-item" onclick="mudarTab('config', this)">
          <span class="nav-icon">‚öôÔ∏è</span> Configura√ß√µes
        </button>
      </nav>
      <div class="user-box">
        <div class="lbl">Logado como</div>
        <div class="name" id="sideUsuario">‚Äî</div>
        <button class="btn-logout-desk" onclick="fazerLogout()">
          Sair do Sistema
        </button>
      </div>
    </aside>

    <!-- Scrollable content -->
    <div class="content-scroll">
      <!-- ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ -->
      <div class="page active" id="tab-dash">
        <div class="greeting">
          <h1>Ol√°, <span id="nomeOperador">Operador</span> üëã</h1>
          <p>Unidade: <span class="unit" id="txtUnidade">‚Äî</span></p>
        </div>
        <div class="cards-grid">
          <div class="card-stat green">
            <div class="lbl">Recebido</div>
            <div class="val" id="cardReceitas">R$ 0,00</div>
          </div>
          <div class="card-stat rose">
            <div class="lbl">Pago</div>
            <div class="val" id="cardPago">R$ 0,00</div>
          </div>
          <div class="card-stat orange">
            <div class="lbl">Fluxo</div>
            <div class="val" id="cardFluxo">R$ 0,00</div>
          </div>
          <div class="card-stat slate">
            <div class="lbl">Saldo Pr√©vio</div>
            <div class="val" id="cardPrevio">R$ 0,00</div>
          </div>
          <div class="card-stat highlight">
            <div class="lbl">Saldo em Caixa</div>
            <div class="val" id="cardSaldo">R$ 0,00</div>
          </div>
        </div>
        <div class="chart-row">
          <div class="chart-box">
            <h4>Propor√ß√£o</h4>
            <canvas id="graficoPizza"></canvas>
          </div>
          <div class="chart-box">
            <h4>Comparativo</h4>
            <canvas id="graficoBarras"></canvas>
          </div>
        </div>
      </div>

     
      <!-- ‚îÄ‚îÄ NOVO LAN√áAMENTO ‚îÄ‚îÄ -->
      <div class="page" id="tab-lancar">
        <div class="page-header"><span class="bar"></span> Novo Registro</div>
        <div class="form-card">
          <div class="field">
            <label>Data</label><input type="date" id="data" />
          </div>
          <div class="field">
            <label>Descri√ß√£o</label>
            <select id="desc" onchange="preencherDescricao(this.value)">
              <option value="">Selecione uma descri√ß√£o...</option>
              <!-- As descri√ß√µes ser√£o carregadas aqui via JavaScript -->
            </select>
            <input type="text" id="descManual" placeholder="Ou digite manualmente"
              style="margin-top: 8px; display: none;" />
          </div>
          <div class="row2">
            <div class="field">
              <label>Tipo</label>
              <select id="tipoOperacao">
                <option value="recebido">Entrada (Recebido)</option>
                <option value="pago">Sa√≠da (Pagamento)</option>
              </select>
            </div>
            <div class="field">
              <label>Valor (R$)</label>
              <input type="number" step="0.01" id="valor" placeholder="0,00" inputmode="decimal" />
            </div>
          </div>

          <div class="form-actions">
            <button class="btn-primary" id="btnLancar" onclick="lancar()">
              <span class="btn-icon">üíæ</span>
              <span class="btn-text">Salvar no Livro</span>
            </button>
            <button class="btn-clean" onclick="limparCamposLancamento()">
              <span class="btn-icon">üßπ</span>
              <span class="btn-text">Limpar Campos</span>
            </button>
          </div>
        </div>
      </div>
      <!-- ‚îÄ‚îÄ LIVRO DE CAIXA ‚îÄ‚îÄ -->
      <div class="page" id="tab-historico">
        <div class="livro-header">
          <div class="page-header">
            <span class="bar"></span> Livro de Caixa
          </div>
        </div>
        <div class="saldo-previo-banner">
          <div>
            <div class="lbl">Saldo Pr√©vio</div>
          </div>
          <div class="val" id="bannerPrevio">R$ 0,00</div>
        </div>

        <div class="filter-strip">
          <div class="filter-label">üìÑ Gerar PDF por per√≠odo</div>
          <div class="filter-row">
            <select id="filtroTipo" onchange="atualizarFiltroPeriodo()">
              <option value="mes">Por M√™s</option>
              <option value="periodo">Por Per√≠odo</option>
            </select>
            <div id="wrapMes" style="display: contents">
              <select id="filtroMes"></select>
              <select id="filtroMesAno"></select>
            </div>
            <div id="wrapPeriodo" style="display: none; display: none; contents: none">
              <input type="date" id="filtroPeriodoInicio" />
              <input type="date" id="filtroPeriodoFim" />
            </div>
            <button class="btn-pdf" onclick="gerarPDFLivroCaixa()">
              üìÑ PDF
            </button>
          </div>
        </div>

        <div id="libroCards"></div>
      </div>

    
      <!-- ‚îÄ‚îÄ CONFIGURA√á√ïES ‚îÄ‚îÄ -->
<div class="page" id="tab-config">
  <div class="config-header">
    <div class="page-header">
      <span class="bar"></span> Configura√ß√µes
    </div>
    <p class="config-subtitle">Gerencie as configura√ß√µes do sistema</p>
  </div>

  <div class="config-grid">
    <!-- SE√á√ÉO: SALDO INICIAL -->
    <div class="config-section">
      <div class="section-header">
        <div class="section-icon">üí∞</div>
        <div>
          <h3 class="section-title">Saldo Inicial</h3>
          <p class="section-subtitle">‚ö†Ô∏è Requer senha de autoriza√ß√£o</p>
        </div>
      </div>

      <div class="config-form">
        <div class="field-group">
          <label class="field-label">Novo Saldo Inicial (R$)</label>
          <div class="input-with-prefix">
            <span class="input-prefix">R$</span>
            <input type="number" step="0.01" id="inputSaldoPrevio" placeholder="0,00" class="field-input" />
          </div>
        </div>
        
        <div class="field-group">
          <label class="field-label">üîê Senha de Confirma√ß√£o</label>
          <div class="pwd-wrap">
            <input type="password" id="senhaConfirmacao" placeholder="Senha de autoriza√ß√£o" class="field-input"
              onkeypress="if (event.key === 'Enter') salvarConfiguracoes();" />
            <button type="button" class="pwd-toggle" onclick="toggleSenha('senhaConfirmacao', this)">
              üëÅÔ∏è
            </button>
          </div>
        </div>
        
        <div class="config-messages">
          <div class="msg-erro" id="msgErroConfig"></div>
          <div class="msg-sucesso" id="msgSucessoConfig" style="display: none;">
            ‚úÖ Saldo atualizado com sucesso!
          </div>
        </div>
        
        <button class="btn-save" id="btnSalvarConfig" onclick="salvarConfiguracoes()">
          <span class="btn-icon">üíæ</span>
          <span class="btn-text">Atualizar Saldo</span>
        </button>
      </div>
    </div>

    <!-- SE√á√ÉO: CADASTRO DE DESCRI√á√ïES -->
    <div class="config-section">
      <div class="section-header">
        <div class="section-icon">üìù</div>
        <div>
          <h3 class="section-title">Descri√ß√µes</h3>
          <p class="section-subtitle">Gerenciar descri√ß√µes dos lan√ßamentos</p>
        </div>
      </div>

      <div class="config-form">
        <div class="field-group">
          <label class="field-label">Nova Descri√ß√£o</label>
          <div class="input-with-button">
            <input type="text" id="novaDescricao" placeholder="Ex: Pagamento de fornecedor" class="field-input" />
            <button class="btn-add" onclick="cadastrarDescricao()" title="Adicionar descri√ß√£o">
              <span>‚ûï</span>
            </button>
          </div>
        </div>

        <div class="config-messages">
          <div class="msg-erro" id="msgErroDescricao" style="display: none;"></div>
          <div class="msg-sucesso" id="msgSucessoDescricao" style="display: none;"></div>
        </div>

        <div class="descricoes-container">
          <div class="container-header">
            <h4>Descri√ß√µes Cadastradas</h4>
            <span class="badge-count" id="contadorDescricoes">0</span>
          </div>
          <div id="listaDescricoes" class="descricoes-list">
            <!-- As descri√ß√µes ser√£o carregadas aqui -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- SE√á√ÉO: INFORMA√á√ïES DO SISTEMA -->
  <div class="info-card">
    <div class="info-header">
      <div class="info-icon">‚ÑπÔ∏è</div>
      <h4>Informa√ß√µes do Sistema</h4>
    </div>
    <div class="info-content">
      <p><strong>Saldo Inicial:</strong> Valor em caixa antes dos lan√ßamentos. A altera√ß√£o requer senha para seguran√ßa.</p>
      <p><strong>Descri√ß√µes:</strong> Cadastre descri√ß√µes que aparecer√£o como sugest√£o ao fazer lan√ßamentos.</p>
      <div class="info-footer">
        <span class="version">Vers√£o 1.0.0</span>
        <span class="status">‚óè Sistema Operacional</span>
      </div>
    </div>
  </div>
</div>
    <!-- Bottom nav (mobile only) -->
    <nav class="bottom-nav">
      <button class="nav-btn active" onclick="mudarTab('dash', this)">
        <span class="nav-icon">üìä</span> Dashboard
      </button>
      <button class="nav-btn" onclick="mudarTab('lancar', this)">
        <span class="nav-icon">‚ûï</span> Novo
      </button>
      <button class="nav-btn" onclick="mudarTab('historico', this)">
        <span class="nav-icon">üìñ</span> Livro
      </button>
      <button class="nav-btn" onclick="mudarTab('config', this)">
        <span class="nav-icon">‚öôÔ∏è</span> Config
      </button>
    </nav>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     MODAL EDITAR
     ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="modal-overlay" id="modalEditar" onclick="if (event.target === this) fecharModal();">
    <div class="modal-box">
      <div class="modal-top">
        <h3>‚úèÔ∏è Editar Registro</h3>
        <button class="modal-close" onclick="fecharModal()">√ó</button>
      </div>
      <input type="hidden" id="editId" />
      <div class="field">
        <label>Data</label><input type="date" id="editData" />
      </div>
      <div class="field">
        <label>Descri√ß√£o</label><input type="text" id="editDesc" />
      </div>
      <div class="row2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px">
        <div class="field">
          <label>Tipo</label>
          <select id="editTipo">
            <option value="recebido">Entrada (Recebido)</option>
            <option value="pago">Sa√≠da (Pagamento)</option>
          </select>
        </div>
        <div class="field">
          <label>Valor (R$)</label>
          <input type="number" step="0.01" id="editValor" inputmode="decimal" />
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-primary" id="btnSalvarEditar" onclick="salvarEditar()">
          Salvar
        </button>
        <button class="btn-cancel" onclick="fecharModal()">Cancelar</button>
      </div>
    </div>
  </div>

  <script src="script.js"></script>
 
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js')
      .then(() => console.log("App Pronto para instalar!"))
      .catch(err => console.log("Erro no registro do SW:", err));
  }
</script>   
</body>
</html>




